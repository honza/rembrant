// Generated by CoffeeScript 1.3.1
(function(){var a,b,c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function d(){this.constructor=a}for(var c in b)l.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};f=null,j=null,g={isSmall:"photoGalleryIsSmall"},i=200,k=function(a){var b;return a?b="1":b="0",$.cookie(g.isSmall,b)},h=function(){return $.cookie(g.isSmall)==="1"},b=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.name="Photo",b.prototype.thumb=function(a){return""+this.get("filename").split(".")[0]+"_"+a+".jpg"},b}(Backbone.Model),c=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return m(c,a),c.name="PhotoCollection",c.prototype.model=b,c}(Backbone.Collection),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.name="PhotoView",b.prototype.events={"click a":"click"},b.prototype.click=function(){return j.navigate("i/"+this.model.get("filename"),{trigger:!0})},b.prototype.render=function(a){var b,c;return a?(b="span2",c=""+this.model.thumb(160)):(b="span12",c=""+this.model.thumb(930)),this.$el.html('<div class="'+b+'">\n    <a href="javascript:;" class="thumbnail">\n        <img src="'+c+'" />\n    </a>\n</div>')},b}(Backbone.View),a=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.name="GalleryView",b.prototype.events={"click #big":"showBig","click #small":"showSmall"},b.prototype.initialize=function(){return this.photoCollection=new c(data.photos),this.$el=$("#root"),this.$photos=$("#photos"),this.isSmall=h()},b.prototype.render=function(){return this.renderPage(1)},b.prototype.renderSingle=function(a){var b,c;return b=this.photoCollection.find(function(b){return a===b.get("filename")}),b?(c=new d({model:b}),this.$photos.empty(),this.$photos.append(c.render(!1))):this.$photos.html("<h1>Not Found</h1>")},b.prototype.renderPage=function(a){var b,c,e,f,g,h,j,k;this.$photos.empty(),c=this.photoCollection.models,b=c.length-i*a,f=b-i,c=c.slice(f,b+1||9e9).reverse(),k=[];for(h=0,j=c.length;h<j;h++)e=c[h],g=new d({model:e}),k.push(this.$photos.append(g.render(this.isSmall)));return k},b.prototype.showBig=function(){return this.isSmall=!1,k(!1),this.render()},b.prototype.showSmall=function(){return this.isSmall=!0,k(!0),this.render()},b}(Backbone.View),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.name="Router",b.prototype.initialize=function(a){return this.app=a.app},b.prototype.routes={"":"root","i/:filename":"image","p/:number":"page"},b.prototype.root=function(){return this.app.render()},b.prototype.image=function(a){return this.app.renderSingle(a)},b.prototype.page=function(a){return this.app.renderPage(a)},b}(Backbone.Router),$(function(){return f=new a,j=new e({app:f}),Backbone.history.start()})}).call(this);